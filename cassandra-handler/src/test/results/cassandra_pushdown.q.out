PREHOOK: query: DROP TABLE cassandra_hive_pushdown
PREHOOK: type: DROPTABLE
PREHOOK: Input: default@cassandra_hive_pushdown
PREHOOK: Output: default@cassandra_hive_pushdown
POSTHOOK: query: DROP TABLE cassandra_hive_pushdown
POSTHOOK: type: DROPTABLE
POSTHOOK: Input: default@cassandra_hive_pushdown
POSTHOOK: Output: default@cassandra_hive_pushdown
PREHOOK: query: CREATE EXTERNAL TABLE cassandra_hive_pushdown(key int, value string)
STORED BY 'org.apache.hadoop.hive.cassandra.CassandraStorageHandler'
WITH SERDEPROPERTIES ("cassandra.columns.mapping" = ":key,value" , "cassandra.cf.name" = "pushdown" , "cassandra.host" = "127.0.0.1" , "cassandra.port" = "9160", "cassandra.partitioner" = "org.apache.cassandra.dht.RandomPartitioner" )
TBLPROPERTIES ("cassandra.ks.name" = "Hive", "cassandra.ks.repfactor" = "1", "cassandra.ks.strategy" = "org.apache.cassandra.locator.SimpleStrategy")
PREHOOK: type: CREATETABLE
POSTHOOK: query: CREATE EXTERNAL TABLE cassandra_hive_pushdown(key int, value string)
STORED BY 'org.apache.hadoop.hive.cassandra.CassandraStorageHandler'
WITH SERDEPROPERTIES ("cassandra.columns.mapping" = ":key,value" , "cassandra.cf.name" = "pushdown" , "cassandra.host" = "127.0.0.1" , "cassandra.port" = "9160", "cassandra.partitioner" = "org.apache.cassandra.dht.RandomPartitioner" )
TBLPROPERTIES ("cassandra.ks.name" = "Hive", "cassandra.ks.repfactor" = "1", "cassandra.ks.strategy" = "org.apache.cassandra.locator.SimpleStrategy")
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: default@cassandra_hive_pushdown
PREHOOK: query: INSERT OVERWRITE TABLE cassandra_hive_pushdown
SELECT *
FROM src
PREHOOK: type: QUERY
PREHOOK: Input: default@src
PREHOOK: Output: default@cassandra_hive_pushdown
POSTHOOK: query: INSERT OVERWRITE TABLE cassandra_hive_pushdown
SELECT *
FROM src
POSTHOOK: type: QUERY
POSTHOOK: Input: default@src
POSTHOOK: Output: default@cassandra_hive_pushdown
PREHOOK: query: -- with full pushdown
explain select * from cassandra_hive_pushdown where key=90
PREHOOK: type: QUERY
POSTHOOK: query: -- with full pushdown
explain select * from cassandra_hive_pushdown where key=90
POSTHOOK: type: QUERY
ABSTRACT SYNTAX TREE:
  (TOK_QUERY (TOK_FROM (TOK_TABREF (TOK_TABNAME cassandra_hive_pushdown))) (TOK_INSERT (TOK_DESTINATION (TOK_DIR TOK_TMP_FILE)) (TOK_SELECT (TOK_SELEXPR TOK_ALLCOLREF)) (TOK_WHERE (= (TOK_TABLE_OR_COL key) 90))))

STAGE DEPENDENCIES:
  Stage-1 is a root stage
  Stage-0 is a root stage

STAGE PLANS:
  Stage: Stage-1
    Map Reduce
      Alias -> Map Operator Tree:
        cassandra_hive_pushdown 
          TableScan
            alias: cassandra_hive_pushdown
            Filter Operator
              predicate:
                  expr: (key = 90)
                  type: boolean
              Filter Operator
                predicate:
                    expr: (key = 90)
                    type: boolean
                Select Operator
                  expressions:
                        expr: key
                        type: int
                        expr: value
                        type: string
                  outputColumnNames: _col0, _col1
                  File Output Operator
                    compressed: false
                    GlobalTableId: 0
                    table:
                        input format: org.apache.hadoop.mapred.TextInputFormat
                        output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat

  Stage: Stage-0
    Fetch Operator
      limit: -1


PREHOOK: query: select * from cassandra_hive_pushdown where key=90
PREHOOK: type: QUERY
PREHOOK: Input: default@cassandra_hive_pushdown
PREHOOK: Output: file:/var/folders/b-/b-vBB2wVHpaVQzxVjeViaE+++TI/-Tmp-/yeweizhang/hive_2011-05-24_16-58-26_992_2055464156518799189/-mr-10000
POSTHOOK: query: select * from cassandra_hive_pushdown where key=90
POSTHOOK: type: QUERY
POSTHOOK: Input: default@cassandra_hive_pushdown
POSTHOOK: Output: file:/var/folders/b-/b-vBB2wVHpaVQzxVjeViaE+++TI/-Tmp-/yeweizhang/hive_2011-05-24_16-58-26_992_2055464156518799189/-mr-10000
90	val_90
PREHOOK: query: DROP TABLE cassandra_hive_pushdown
PREHOOK: type: DROPTABLE
PREHOOK: Input: default@cassandra_hive_pushdown
PREHOOK: Output: default@cassandra_hive_pushdown
POSTHOOK: query: DROP TABLE cassandra_hive_pushdown
POSTHOOK: type: DROPTABLE
POSTHOOK: Input: default@cassandra_hive_pushdown
POSTHOOK: Output: default@cassandra_hive_pushdown
